(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{202:function(t,e,n){"use strict";n.r(e);var r={name:"transactions",props:["tx"],data:function(){return{dialogTx:null,dialog:!1,actionsMap:{FUND_UNPERFORMED_TX:{current:"Нужно подготовить счет к выводу",needPrepare:!0,prepared:!1},FUND_WAIT_PREPARE_TX:{current:'Транзакция отправлена, проверяйте счет. Если баланс есть, то жмите "Вывести"',needPrepare:!0,prepared:!0},FUND_PREPARED_TX:{current:'Вывод средств осуществлен системой. Ожидается перевод транзакции в статус "Исполнено"',needPrepare:!1,prepared:!0},FUND_PERFORMED_TX:{current:"Исполнено",needPrepare:!1,prepared:!1}},headers:[{text:"CURRENCY",align:"right",value:"currencySymbol"},{text:"TXID",align:"right",value:"id"},{text:"ADDRESS",align:"right",value:"toAddress"},{text:"TIME",align:"right",value:"createdAt"},{text:"REASON",value:"reason",align:"right"},{text:"AMOUNT",value:"amount",align:"right"},{text:"STATUS",value:"status",align:"right"},{text:"ACTION",value:"status",align:"right"}],reasonStatus:["UNREASON_TX","FUND_UNPERFORMED_TX","FUND_WAIT_PREPARE_TX","FUND_PREPARED_TX","FUND_PERFORMED_TX","WITHDRAW_TX","SELLER_CONTRACT_TX","BUYER_CONTRACT_TX","CONTRACT_COMMISSION_TX"],txStatus:["UNCONFIRMED","COLLATERALIZED","SAVED","CONFIRMED","CANCELED"],accBalance:!1}},computed:{psInTx:function(){return!!this.tx.reason.inPStxId&&this.tx.reason.inPStxId},psPrepareTx:function(){return!!this.tx.reason.preparePStxId&&this.tx.reason.preparePStxId},psOutTx:function(){return!!this.tx.reason.outPStxId&&this.tx.reason.outPStxId},address:function(){return this.tx.toAddress},actions:function(){return this.actionsMap[this.status]},status:function(){return this.reasonStatus[this.tx.reason.status]}},methods:{openDialog:function(){this.dialog=!0},isBase:function(t){return t===this.base},toDate:function(t){var a=new Date(1e3*t),e=a.getFullYear(),n=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][a.getMonth()];return a.getDate()+" "+n+" "+e+" "+a.getHours()+":"+a.getMinutes()+":"+a.getSeconds()},balance:function(){return this.accountBalance||this.$axios.get("https://api.etherscan.io/api?module=account&action=balanc&tag=latest&apikey=YourApiKeyTokene&address="+this.address).then(function(t){console.log(t)}),this.accountBalance},needPrepare:function(){this.$axios.post("/_v1-a/need-prepare-txs",{txsId:[this.tx.id]}).then(function(t){console.log(t)})},prepared:function(){this.$axios.post("/_v1-a/txs-prepared",{txsId:[this.tx.id]}).then(function(t){console.log(t)})}}},o=n(22),c={name:"txasmaster",components:{TxPerformProccess:Object(o.a)(r,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("v-dialog"),t._v(" "),n("v-card",[n("v-card-title",{staticClass:"headline grey lighten-2",attrs:{"primary-title":""}},[t._v("\n      Управление выводом транзакций\n    ")]),t._v(" "),n("v-card-text",[n("p",[t._v("Памятка:")]),t._v(" "),n("p",[t._v("Пользователь пополнил свой счет. Нужно произвести вывод с него на мастер-счет на котором аккумулируются средства.")]),t._v(" "),n("p",[t._v("Все транзакции требуют оплату в ETH. Но на токен счетах пользователей ETH нет, соответственно произвести вывод нельзя.")]),t._v(" "),n("p",[t._v("Это окошко предлагает следующее решение:")]),t._v(" "),n("p",[t._v("Проверяет баланс счета с которого нужно произвести вывод, если баланс меньше цены за транзакцию,\n        появится кнопка создания пополняющей счет транзакции. При её нажатии со счета администратора будет создана\n        транзакция на сумму которой хватит для оплаты комиссии, а транзакция в системе будет переведена в статус\n        ожидания подтверждения.\n      ")]),t._v(" "),n("p",[t._v("\n        Если баланса для оплаты комиссии на счете достаточно, появится кнопка создания выходной транзакции на мастер-счет.\n      ")])]),t._v(" "),t.tx?n("v-card-text",[n("p",[t._v("\n        Инфо:\n      ")]),t._v(" "),n("p",{staticClass:"caption"},[t._v("\n        Посмотреть баланс: "),n("a",{attrs:{target:"_blank",href:"https://api.etherscan.io/api?module=account&action=balance&tag=latest&address="+t.address}},[t._v(t._s(t.address))])]),t._v(" "),n("p",{staticClass:"caption"},[t._v("\n        Входящая транзакция: "),n("a",{attrs:{target:"_blank",href:"https://etherscan.io/tx/"+t.psInTx}},[t._v(t._s(t.psInTx))])]),t._v(" "),n("p",{staticClass:"caption"},[t._v("\n        Транзакция подготовки: "),n("a",{attrs:{target:"_blank",href:"https://etherscan.io/tx/"+t.psPrepareTx}},[t._v(t._s(t.psPrepareTx))])]),t._v(" "),n("p",{staticClass:"caption"},[t._v("\n        Транзакция на вывод: "),n("a",{attrs:{target:"_blank",href:"https://etherscan.io/tx/"+t.psOutTx}},[t._v(t._s(t.psOutTx))])]),t._v(" "),n("p",{staticClass:"caption"},[t._v("\n        Текущий статус: "),n("code",[t._v(t._s(t.reasonStatus[t.tx.reason.status]))])]),t._v(" "),n("p",{staticClass:"caption"},[t._v("\n        "+t._s(t.actions.current)+"\n      ")]),t._v(" "),n("v-divider"),t._v(" "),t.psOutTx?t._e():n("v-layout",{staticClass:"mt-5 mb-3",attrs:{wrap:""}},[t.actions.needPrepare&&!t.psPrepareTx?n("v-flex",{staticClass:"pr-1",attrs:{md12:""}},[n("v-btn",{staticClass:"success",attrs:{block:""},on:{click:t.needPrepare}},[t._v("Подготовить")])],1):t._e(),t._v(" "),t.actions.prepared&&!t.psOutTx?n("v-flex",{staticClass:"pl-1",attrs:{md12:""}},[n("v-btn",{staticClass:"warning",attrs:{block:""},on:{click:t.prepared}},[t._v(" Вывести")])],1):t._e()],1)],1):n("v-card-text",[n("v-progress-linear",{staticClass:"mb-0",attrs:{indeterminate:""}})],1)],1)],1)},[],!1,null,"426c1a92",null).exports},computed:{notPerformedTxs:function(){return this.$store.state.objects.txs.filter(function(t){return t.reason.status<4})}},data:function(){return{dialogTx:null,dialog:!1,headers:[{text:"CURRENCY",align:"right",value:"currencySymbol"},{text:"TXID",align:"right",value:"id"},{text:"ADDRESS",align:"right",value:"toAddress"},{text:"TIME",align:"right",value:"createdAt"},{text:"REASON",value:"reason",align:"right"},{text:"AMOUNT",value:"amount",align:"right"},{text:"STATUS",value:"status",align:"right"},{text:"ACTION",value:"status",align:"right"}],reasonStatus:["UNREASON_TX","FUND_UNPERFORMED_TX","FUND_WAIT_PREPARE_TX","FUND_PREPARED_TX","FUND_PERFORMED_TX","WITHDRAW_TX","SELLER_CONTRACT_TX","BUYER_CONTRACT_TX","CONTRACT_COMMISSION_TX"],txStatus:["UNCONFIRMED","COLLATERALIZED","SAVED","CONFIRMED","CANCELED"]}},methods:{openDialog:function(t){this.dialogTx=t,this.dialog=!0},isBase:function(t){return t===this.base},toDate:function(t){var a=new Date(1e3*t),e=a.getFullYear(),n=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][a.getMonth()];return a.getDate()+" "+n+" "+e+" "+a.getHours()+":"+a.getMinutes()+":"+a.getSeconds()}}},l=Object(o.a)(c,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-container",{attrs:{fluid:""}},[n("v-dialog",{attrs:{width:"550"},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[n("TxPerformProccess",{attrs:{tx:t.dialogTx}})],1),t._v(" "),n("v-data-table",{staticClass:"elevation-1",attrs:{headers:t.headers,items:t.notPerformedTxs},scopedSlots:t._u([{key:"items",fn:function(e){return[n("td",{staticClass:"text-xs-right"},[t._v(t._s(e.item.currencySymbol))]),t._v(" "),n("td",{staticClass:"text-xs-right"},[t._v(t._s(e.item.id))]),t._v(" "),n("td",{staticClass:"text-xs-right"},[t._v(t._s(e.item.toAddress))]),t._v(" "),n("td",{staticClass:"text-xs-right"},[t._v(t._s(t.toDate(e.item.createdAt)))]),t._v(" "),n("td",{staticClass:"text-xs-right"},[t._v("\n        "+t._s(t.reasonStatus[e.item.reason.status])+"\n      ")]),t._v(" "),n("td",{staticClass:"text-xs-right"},[t._v(t._s(e.item.amount))]),t._v(" "),n("td",{staticClass:"text-xs-right"},[t._v(t._s(t.txStatus[e.item.status]))]),t._v(" "),n("td",{staticClass:"text-xs-right"},[n("v-btn",{attrs:{color:"primary"},on:{click:function(n){return t.openDialog(e.item)}}},[t._v("Детали")])],1)]}}])})],1)},[],!1,null,"66250205",null);e.default=l.exports}}]);