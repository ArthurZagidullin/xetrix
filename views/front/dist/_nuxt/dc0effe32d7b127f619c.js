(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{187:function(t,e,r){var content=r(193);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,r(40).default)("76d96cef",content,!0,{sourceMap:!1})},192:function(t,e,r){"use strict";var n=r(187);r.n(n).a},193:function(t,e,r){(t.exports=r(39)(!1)).push([t.i,".m1[data-v-1b7bc0c2]{margin-top:20px}",""])},194:function(t,e,r){"use strict";r.r(e);r(70),r(23);var n={name:"Bitcoin",props:["acc"],data:function(){return{amount:0,sendingAddress:"",fullName:"",attributes:[]}},methods:{send:function(){this.$axios.post("/_v1/create_withdrawal")}}},c=r(22),o=Object(c.a)(n,function(){var t=this.$createElement,e=this._self._c||t;return e("v-flex",{attrs:{md12:""}},[e("v-text-field",{attrs:{label:"Bitcoin address"}})],1)},[],!1,null,"4c0d608e",null).exports,l={name:"YandexMoney",props:["acc"],data:function(){return{paymentSystem:"YandexMoney",amount:0,fullName:"",address:"",worder:""}},computed:{attributes:function(){return[{key:"fullName",value:this.fullName},{key:"YandexMoneyAddress",value:this.address}]}},methods:{send:function(){var t=this;this.$axios.post("/_v1/create_withdrawal",{paymentSystem:this.paymentSystem,amount:this.amount,sendingAddress:this.acc.account.Address,attributes:this.attributes}).then(function(e){console.log(e.data),t.worder=e.data,t.reset()})},reset:function(){this.amount=0,this.fullName="",this.address=""}}},d={name:"acc",props:["acc","ps"],components:{YandexMoney:Object(c.a)(l,function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("v-container",[r("v-flex",{attrs:{md12:""}},[r("v-text-field",{attrs:{label:"Количество"},model:{value:t.amount,callback:function(e){t.amount=e},expression:"amount"}})],1),t._v(" "),r("v-flex",{attrs:{md12:""}},[r("v-text-field",{attrs:{label:"Адрес счета"},model:{value:t.address,callback:function(e){t.address=e},expression:"address"}})],1),t._v(" "),r("v-flex",{attrs:{md12:""}},[r("v-text-field",{attrs:{label:"ФИО"},model:{value:t.fullName,callback:function(e){t.fullName=e},expression:"fullName"}})],1),t._v(" "),r("v-flex",{staticClass:"text-md-right",attrs:{md12:""}},[r("v-btn",{staticClass:"amber accend-3 ml-0 mt-3 mb-0",on:{click:t.send}},[t._v("Подать заявку")])],1),t._v(" "),t.worder?r("v-flex",[r("p",{staticClass:"title"},[t._v("\n      Создана заявка:\n    ")]),t._v(" "),r("p",[t._v("\n      "+t._s(t.worder)+"\n    ")])]):t._e()],1)},[],!1,null,"c9d90afe",null).exports,Bitcoin:o},computed:{currency:function(){return this.acc.account.currency.name},symbol:function(){return this.acc.account.currency.symbol},available:function(){return this.acc.balance.available>0?this.acc.balance.available:0},locked:function(){return this.acc.balance.locked>0?this.acc.balance.locked:0},address:function(){return this.acc.account.Address}},data:function(){return{paymentDialog:!1,withdrawalDialog:!1}}},v=Object(c.a)(d,function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",["RUB"===t.symbol?r("v-dialog",{attrs:{width:"500"},model:{value:t.paymentDialog,callback:function(e){t.paymentDialog=e},expression:"paymentDialog"}},[r("v-card",[r("v-card-title",[r("span",{staticClass:"title"},[t._v("Платеж")]),t._v(" "),r("v-spacer"),t._v(" "),r("v-icon",{on:{click:function(e){t.paymentDialog=!t.paymentDialog}}},[t._v("close")])],1),t._v(" "),r("v-card-text",[r("iframe",{attrs:{src:"https://money.yandex.ru/quickpay/shop-widget?writer=seller&targets="+t.address+"&label="+t.address+"&targets-hint=&default-sum=2&button-text=11&payment-type-choice=on&hint=&successURL=&quickpay=shop&account=410018657112160",width:"423",height:"222",frameborder:"0",allowtransparency:"true",scrolling:"no"}})])],1)],1):t._e(),t._v(" "),t.ps.length?r("v-dialog",{attrs:{width:"500"},model:{value:t.withdrawalDialog,callback:function(e){t.withdrawalDialog=e},expression:"withdrawalDialog"}},[r("v-card",[r("v-card-title",[r("p",{staticClass:"title mb-0 pb-0"},[t._v("\n          Заявка на вывод "),r("br"),t._v(" "),r("span",{staticClass:"caption"},[t._v(t._s(t.address))])]),t._v(" "),r("v-spacer"),t._v(" "),r("v-icon",{on:{click:function(e){t.withdrawalDialog=!t.withdrawalDialog}}},[t._v("close")])],1),t._v(" "),r("v-card-text",[r("v-tabs",{attrs:{"fixed-tabs":""}},[t._l(t.ps,function(p){return r("v-tab",{key:p.Name},[t._v("\n            "+t._s(p.Name)+"\n          ")])}),t._v(" "),t._l(t.ps,function(p){return r("v-tab-item",{key:p.Name},[r("v-card",{attrs:{flat:""}},[r("v-card-text",[r("v-layout",[r(p.Name,{tag:"component",attrs:{acc:t.acc}})],1)],1)],1)],1)})],2)],1)],1)],1):t._e(),t._v(" "),r("v-card",[r("v-card-title",{staticClass:"grey white--text"},[r("v-flex",{attrs:{md3:""}},[r("span",{staticClass:"title"},[t._v("Счет")])]),t._v(" "),r("v-spacer"),t._v(" "),r("v-flex",[r("p",{staticClass:"text-xs-right ma-0"},[r("span",{staticClass:"title"},[r("b",[t._v(t._s(t.currency))])])])])],1),t._v(" "),r("v-card-text",{},[r("v-layout",{attrs:{row:"",wrap:""}},[r("v-flex",{attrs:{md2:"","d-flex":""}},[r("p",{staticClass:"text-xs-left"},[t._v(t._s(t.symbol))])]),t._v(" "),r("v-flex",{attrs:{md3:"","d-flex":""}},[t._v("Доступно:")]),t._v(" "),r("v-spacer"),t._v(" "),r("v-flex",{staticClass:"text-xs-right",attrs:{md6:"","d-flex":""}},[r("p",{staticClass:"text-xs-right"},[r("b",[t._v(t._s(t.available))])])])],1),t._v(" "),r("v-layout",{staticClass:"mt-3",attrs:{row:"",wrap:""}},[r("v-flex",{attrs:{md2:"","d-flex":""}},[r("p",{staticClass:"text-xs-left"},[t._v(t._s(t.symbol))])]),t._v(" "),r("v-flex",{attrs:{md3:"","d-flex":""}},[t._v("Заблокировано:")]),t._v(" "),r("v-spacer"),t._v(" "),r("v-flex",{attrs:{md6:"","d-flex":""}},[r("p",{staticClass:"text-xs-right"},[r("b",[t._v(t._s(t.locked))])])])],1)],1),t._v(" "),r("v-card-actions",{staticClass:"grey lighten-2 pa-0"},[t.ps.length?[r("v-btn",{staticClass:"amber accent-3 ma-0",attrs:{block:"",flat:"",small:""},on:{click:function(e){t.paymentDialog=!t.paymentDialog}}},[t._v("Пополнить")]),t._v(" "),r("v-btn",{staticClass:"amber accent-3 ma-0",attrs:{block:"",flat:"",small:""},on:{click:function(e){t.withdrawalDialog=!t.withdrawalDialog}}},[t._v("Вывести")])]:t._e()],2)],1)],1)},[],!1,null,"ee5b1512",null).exports,m=(r(105),r(12),{name:"orderForm",props:["accs"],computed:{currencies:function(){var t=[];return this.accs.forEach(function(a){t.findIndex(function(t){return a.account.currency.symbol===t.symbol})<0&&t.push(a.account.currency)}),t},toList:function(){var t=this;return this.from?this.currencies.filter(function(e){return e.symbol!==t.from}):this.currencies},send:function(){var t=this;if(this.from){var e=this.accs.filter(function(a){return a.account.currency.symbol===t.from})[0];if(e.account)return e.account.Address}return!1},receive:function(){var t=this;if(this.to){var e=this.accs.filter(function(a){return a.account.currency.symbol===t.to})[0];if(e.account)return e.account.Address}return!1},query:function(){var q={};return q.sendingAddress=this.send,q.receiveAddress=this.receive,q.amount=this.amount,q.price=this.price,console.log(q),!!(q.sendingAddress&&q.receiveAddress&&q.price&&q.amount)&&q}},data:function(){return{amount:0,price:0,from:"",to:""}},methods:{open:function(){var q=this.query;if(this.query){this.$axios.post("/_v1/create_order",q).then(function(t){console.log(t)})}}}}),f=Object(c.a)(m,function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("v-card",[r("v-card-title",{staticClass:"grey white--text pb-0"},[r("v-layout",{attrs:{row:""}},[r("v-flex",[r("span",{staticClass:"title"},[t._v("Размещение ордера")])]),t._v(" "),r("v-flex",[r("p",{staticClass:"text-xs-right"},[r("v-btn",{staticClass:"ma-0",attrs:{color:"primary",disabled:!t.query,small:""},on:{click:t.open}},[t._v("Опубликовать")])],1)])],1)],1),t._v(" "),r("v-card-text",{staticClass:"pl-3 pr-3 pb-0"},[r("v-layout",{attrs:{row:"",wrap:"","justify-space-between":""}},[r("v-flex",{attrs:{md5:""}},[r("p",{staticClass:"ma-0 mb-2"},[t._v("\n          Что продаем?\n        ")]),t._v(" "),r("v-layout",{attrs:{row:"",wrap:""}},[r("v-flex",{attrs:{"d-flex":"",md6:""}},[r("v-text-field",{attrs:{label:"Кол-во",solo:"",disabled:!t.from},model:{value:t.amount,callback:function(e){t.amount=e},expression:"amount"}})],1),t._v(" "),r("v-flex",{attrs:{"d-flex":"",md6:""}},[r("v-select",{staticClass:"elevation-0",attrs:{items:t.currencies,"item-text":"symbol","item-value":"symbol",label:"Продам",solo:""},model:{value:t.from,callback:function(e){t.from=e},expression:"from"}})],1)],1)],1),t._v(" "),r("v-flex",{attrs:{md1:""}},[r("p",{staticClass:"mt-5 mr-0 ml-0 text-xs-center"},[t._v("за")])]),t._v(" "),r("v-flex",{attrs:{md5:""}},[r("p",{staticClass:"text-xs-right ma-0 mb-2"},[t._v("\n          Почем?\n        ")]),t._v(" "),r("v-layout",{attrs:{row:"",wrap:""}},[r("v-flex",{attrs:{"d-flex":"",md6:""}},[r("v-text-field",{staticClass:"elevation-0",attrs:{label:"Цена за ед.",solo:"",disabled:!t.to},model:{value:t.price,callback:function(e){t.price=e},expression:"price"}})],1),t._v(" "),r("v-flex",{attrs:{"d-flex":"",md6:""}},[r("v-select",{attrs:{items:t.toList,"item-text":"symbol","item-value":"symbol",label:"Куплю",solo:"",disabled:!t.from},model:{value:t.to,callback:function(e){t.to=e},expression:"to"}})],1)],1)],1)],1),t._v(" "),r("v-layout",{attrs:{row:"",wrap:"","justify-space-between":""}})],1),t._v(" "),r("v-card-actions",{staticClass:"pt-0"},[r("v-spacer")],1)],1)},[],!1,null,"1ca5e71c",null).exports,h={name:"simple",props:["order"],computed:{wsaccs:function(){return this.$store.state.objects.WsAccounts},id:function(){return this.order.id},buyerId:function(){return this.$auth.user.id},send:function(){var t=this,e=this.wsaccs.filter(function(a){return a.account.currency.symbol===t.to})[0];return!!e.account&&e.account.Address},receive:function(){var t=this,e=this.wsaccs.filter(function(a){return a.account.currency.symbol===t.from})[0];return!!e.account&&e.account.Address},from:function(){return this.order.sellCurrencySymbol},to:function(){return this.order.buyCurrencySymbol},available:function(){return this.order.available},price:function(){return this.order.price},query:function(){var q={};return q.orderId=this.id,q.sendingAddress=this.send,q.receiveAddress=this.receive,q.buyerId=this.buyerId,q.amount=parseFloat(this.amount),q.amount<=this.available&&q.orderId&&q.sendingAddress&&q.receiveAddress&&q.orderId&&q.buyerId?q:(console.log("Something wrong: query ",q),!1)}},data:function(){return{amount:0}},methods:{buy:function(){if(this.query){this.$axios.post("/_v1/create_contract",this.query).catch(function(t){console.log(t)})}}}},x={name:"order",props:["order"],components:{ContractSimpleForm:Object(c.a)(h,function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("v-container",{staticClass:"pa-0",attrs:{fluid:""}},[r("v-layout",{attrs:{row:"",wrap:""}},[r("v-flex",{attrs:{md8s:""}},[r("v-text-field",{attrs:{solo:""},model:{value:t.amount,callback:function(e){t.amount=e},expression:"amount"}})],1),t._v(" "),r("v-flex",{staticClass:" text-md-right",attrs:{md2:""}},[r("v-btn",{staticStyle:{height:"30px",width:"30px"},attrs:{fab:"",color:"white"},on:{click:t.buy}},[r("v-icon",[t._v("add")])],1)],1)],1)],1)},[],!1,null,"957d1dfa",null).exports},computed:{isUser:function(){return this.order.ownerId===this.$auth.user.id},from:function(){return this.order.sellCurrencySymbol},to:function(){return this.order.buyCurrencySymbol},available:function(){return this.order.available},price:function(){return this.order.price}}},_={name:"index",components:{Acc:v,OrderForm:f,Order:Object(c.a)(x,function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("v-card",[r("v-layout",{attrs:{row:"","justify-space-between":""}},[r("v-flex",{staticClass:"grey white--text",attrs:{md3:""}},[r("v-card-title",[r("span",{staticClass:"title"},[t._v("Ордер")])])],1),t._v(" "),r("v-flex",{attrs:{md5:""}},[r("v-card-title",[r("v-layout",{attrs:{row:"","justify-space-between":""}},[r("v-flex",{attrs:{md2:""}},[r("p",{staticClass:"ma-0 text-xs-center"},[r("span",{staticClass:"title"},[t._v(t._s(t.available))]),t._v(" "),r("span",{staticClass:"subheading"},[t._v(t._s(t.from))])])]),t._v(" "),r("v-flex",{attrs:{md1:""}},[r("p",{staticClass:"text-xs-center ma-0"},[r("span",{staticClass:"title"},[t._v("по")])])]),t._v(" "),r("v-flex",{attrs:{md2:""}},[r("p",{staticClass:"ma-0 text-xs-center"},[r("span",{staticClass:"title"},[t._v(t._s(t.price))]),t._v(" "),r("span",{staticClass:"subheading"},[t._v(t._s(t.to))])])])],1)],1)],1),t._v(" "),t.isUser?r("v-flex",{staticClass:"green white--text",attrs:{md2:""}},[r("v-card-title",{staticClass:"text-xs-right"},[r("p",{staticClass:"text-md-right ma-0"},[r("v-icon",[t._v("person")])],1)])],1):r("v-flex",{staticClass:"orange white--text",attrs:{md2:""}},[t.available>0?[r("v-card-title",{staticClass:"text-xs-right"},[r("p",{staticClass:"text-md-right ma-0"},[t._v("\n              Купить "+t._s(t.from)+"\n            ")])]),t._v(" "),r("v-card-title",[r("ContractSimpleForm",{attrs:{order:t.order}})],1)]:t._e()],2)],1)],1)},[],!1,null,"1178bba0",null).exports},fetch:function(t){var e=t.store;return t.app.$axios.get("/payments/systems").then(function(t){e.commit("objects/setPaysystems",t.data)})},data:function(){return{isBordered:!0}},computed:{WsAccounts:function(){return this.$store.state.objects.WsAccounts},orders:function(){return this.$store.state.objects.orders},userOrders:function(){var t=this;return this.orders.filter(function(e){return e.ownerId===t.$auth.user.id})}},methods:{accPS:function(t){return this.$store.state.objects.paysystems.filter(function(e){return t===e.Symbol})}}},y=(r(192),Object(c.a)(_,function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("v-container",{attrs:{fluid:""}},[r("v-layout",{attrs:{row:"",wrap:"","justify-space-between":""}},[r("v-flex",{attrs:{md2:"",sm6:"",xs12:""}},t._l(t.WsAccounts,function(e){return r("v-layout",{key:e.account.id,staticClass:"mt-3",attrs:{row:""}},[r("v-flex",{attrs:{md10:""}},[r("Acc",{attrs:{acc:e,ps:t.accPS(e.account.currency.symbol)}})],1)],1)}),1),t._v(" "),r("v-flex",{attrs:{md5:""}},[r("v-layout",{attrs:{row:""}},[r("v-flex",{attrs:{md12:""}})],1),t._v(" "),t._l(t.orders,function(t){return r("v-layout",{key:t.id,staticClass:"mt-3",attrs:{row:"","justify-end":""}},[r("v-flex",{attrs:{md10:""}},[r("Order",{attrs:{order:t}})],1)],1)})],2),t._v(" "),r("v-flex",{attrs:{md4:""}},[r("v-layout",{staticClass:"mt-3",attrs:{column:"",wrap:"","justify-end":""}},[r("v-flex",{attrs:{md10:""}},[r("OrderForm",{attrs:{accs:t.WsAccounts}})],1),t._v(" "),t._l(t.userOrders,function(t){return r("v-flex",{key:"my"+t.id,staticClass:"mt-3"},[r("Order",{attrs:{order:t}})],1)})],2)],1)],1)],1)},[],!1,null,"1b7bc0c2",null));e.default=y.exports}}]);